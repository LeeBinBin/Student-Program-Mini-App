<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="top-nav">
    <view class="nav-back" bindtap="navigateBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="nav-title">èµ„æºåˆ†äº«</view>
    <view class="nav-actions">
      <view class="action-item" bindtap="publishResource">
        <text class="action-icon">+</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-filter">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input class="search-input" placeholder="æœç´¢èµ„æºåç§°ã€å…³é”®è¯æˆ–æ•™å¸ˆ" bindinput="onSearch" value="{{searchKeyword}}" />
    </view>
    <view class="filter-section">
      <view class="filter-item" bindtap="showFilter('category')">
        <text>{{selectedCategory || 'åˆ†ç±»'}}</text>
        <text class="filter-arrow">â–¼</text>
      </view>
      <view class="filter-item" bindtap="showFilter('subject')">
        <text>{{selectedSubject || 'å­¦ç§‘'}}</text>
        <text class="filter-arrow">â–¼</text>
      </view>
    </view>
  </view>

  <!-- èµ„æºåˆ—è¡¨ -->
  <view class="resources-list">
    <view wx:for="{{resources}}" wx:key="id" class="resource-item">
      <view class="resource-header">
        <view class="teacher-info">
          <view class="teacher-avatar">
            <image src="{{item.teacher.avatar}}" mode="aspectFill"></image>
          </view>
          <view class="teacher-details">
            <view class="teacher-name">{{item.teacher.name}}</view>
            <view class="teacher-school">{{item.teacher.school}}</view>
          </view>
        </view>
        <view class="resource-time">{{item.publishTime}}</view>
      </view>
      <view class="resource-content">
        <view class="resource-title">{{item.title}}</view>
        <view class="resource-description">{{item.description}}</view>
        <view class="resource-tags">
          <view class="tag" style="background-color: {{item.category === 'ç»éªŒåˆ†äº«' ? '#E0F2FE' : item.category === 'æ•™å­¦èµ„æº' ? '#D9F99D' : '#F3E8FF'}}">
            {{item.category}}
          </view>
          <view class="tag" style="background-color: #FEF3C7">
            {{item.subject}}
          </view>
          <view class="tag" wx:if="{{item.crossBorder}}" style="background-color: #E0F2FE">
            è·¨å¢ƒæ•™è‚²
          </view>
        </view>
        <view class="resource-materials" wx:if="{{item.materials && item.materials.length > 0}}">
          <view class="materials-title">ç›¸å…³ç´ æï¼š</view>
          <view class="materials-list">
            <view wx:for="{{item.materials}}" wx:key="index" class="material-item">
              <text class="material-icon">{{item.type === 'æ–‡æ¡£' ? 'ğŸ“„' : item.type === 'è¯¾ä»¶' ? 'ğŸ“Š' : item.type === 'è§†é¢‘' ? 'ğŸ¥' : 'ğŸ“'}}</text>
              <text class="material-name">{{item.name}}</text>
              <view class="material-download" bindtap="downloadMaterial" data-id="{{item.id}}">
                <text class="download-icon">ğŸ“¥</text>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="resource-actions">
        <view class="action-item" bindtap="likeResource" data-id="{{item.id}}">
          <text class="action-icon">{{item.liked ? 'â¤ï¸' : 'ğŸ¤'}}</text>
          <text class="action-text">{{item.likeCount}}</text>
        </view>
        <view class="action-item" bindtap="commentResource" data-id="{{item.id}}">
          <text class="action-icon">ğŸ’¬</text>
          <text class="action-text">{{item.commentCount}}</text>
        </view>
        <view class="action-item" bindtap="shareResource" data-id="{{item.id}}">
          <text class="action-icon">ğŸ“¤</text>
          <text class="action-text">{{item.shareCount}}</text>
        </view>
      </view>
      <view class="resource-comments" wx:if="{{item.comments && item.comments.length > 0}}">
        <view class="comments-title">è¯„è®º ({{item.commentCount}})</view>
        <view class="comments-list">
          <view wx:for="{{item.comments}}" wx:key="index" class="comment-item">
            <view class="comment-avatar">
              <image src="{{item.avatar}}" mode="aspectFill"></image>
            </view>
            <view class="comment-content">
              <view class="comment-header">
                <view class="comment-name">{{item.name}}</view>
                <view class="comment-time">{{item.time}}</view>
              </view>
              <view class="comment-text">{{item.text}}</view>
            </view>
          </view>
        </view>
        <view class="view-more-comments" bindtap="viewMoreComments" data-id="{{item.id}}">
          æŸ¥çœ‹æ›´å¤šè¯„è®º
        </view>
      </view>
    </view>
  </view>

  <!-- æ— æ•°æ®æç¤º -->
  <view wx:if="{{resources.length === 0}}" class="empty-state">
    <text class="empty-icon">ğŸ¤</text>
    <view class="empty-text">æš‚æ— åˆ†äº«èµ„æº</view>
    <view class="empty-desc">ç‚¹å‡»å³ä¸Šè§’å‘å¸ƒç¬¬ä¸€ä¸ªèµ„æº</view>
  </view>

  <!-- ç­›é€‰å¼¹çª— -->
  <view wx:if="{{showFilterModal}}" class="modal" catchtap="hideFilter">
    <view class="modal-content" catchtap="catchTap">
      <view class="modal-header">
        <view class="modal-title">{{filterTitle}}</view>
        <view class="modal-close" bindtap="hideFilter">Ã—</view>
      </view>
      <view class="modal-body">
        <view wx:for="{{filterOptions}}" wx:key="index" class="filter-option" bindtap="selectFilter" data-value="{{item.value}}" data-label="{{item.label}}">
          <text class="option-text">{{item.label}}</text>
          <text wx:if="{{item.value === selectedFilterValue}}" class="option-check">âœ“</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å‘å¸ƒèµ„æºå¼¹çª— -->
  <view wx:if="{{showPublishModal}}" class="modal" catchtap="hidePublishModal">
    <view class="modal-content publish-modal" catchtap="catchTap">
      <view class="modal-header">
        <view class="modal-title">å‘å¸ƒèµ„æº</view>
        <view class="modal-close" bindtap="hidePublishModal">Ã—</view>
      </view>
      <view class="modal-body">
        <view class="form-item">
          <view class="form-label">æ ‡é¢˜</view>
          <input class="form-input" placeholder="è¯·è¾“å…¥èµ„æºæ ‡é¢˜" value="{{publishForm.title}}" bindinput="onPublishInput" data-field="title" />
        </view>
        <view class="form-item">
          <view class="form-label">åˆ†ç±»</view>
          <view class="form-select" bindtap="selectPublishCategory">
            <text>{{publishForm.category || 'è¯·é€‰æ‹©åˆ†ç±»'}}</text>
            <text class="select-arrow">â–¼</text>
          </view>
        </view>
        <view class="form-item">
          <view class="form-label">å­¦ç§‘</view>
          <view class="form-select" bindtap="selectPublishSubject">
            <text>{{publishForm.subject || 'è¯·é€‰æ‹©å­¦ç§‘'}}</text>
            <text class="select-arrow">â–¼</text>
          </view>
        </view>
        <view class="form-item">
          <view class="form-label">æè¿°</view>
          <textarea class="form-textarea" placeholder="è¯·è¾“å…¥èµ„æºæè¿°" value="{{publishForm.description}}" bindinput="onPublishInput" data-field="description"></textarea>
        </view>
        <view class="form-item">
          <view class="form-label">ç›¸å…³ç´ æ</view>
          <view class="form-upload" bindtap="uploadMaterials">
            <text class="upload-icon">+</text>
            <text class="upload-text">ç‚¹å‡»ä¸Šä¼ ç´ æ</text>
          </view>
          <view class="uploaded-materials" wx:if="{{publishForm.materials && publishForm.materials.length > 0}}">
            <view wx:for="{{publishForm.materials}}" wx:key="index" class="uploaded-item">
              <text class="material-icon">{{item.type === 'æ–‡æ¡£' ? 'ğŸ“„' : item.type === 'è¯¾ä»¶' ? 'ğŸ“Š' : item.type === 'è§†é¢‘' ? 'ğŸ¥' : 'ğŸ“'}}</text>
              <text class="material-name">{{item.name}}</text>
              <text class="material-remove" bindtap="removeMaterial" data-index="{{index}}">Ã—</text>
            </view>
          </view>
        </view>
        <view class="form-checkbox">
          <view class="checkbox" bindtap="toggleCrossBorder">
            <view class="checkbox-inner" style="background-color: {{publishForm.crossBorder ? '#165DFF' : 'transparent'}};">
              <text wx:if="{{publishForm.crossBorder}}" class="checkbox-check">âœ“</text>
            </view>
          </view>
          <view class="checkbox-label">è·¨å¢ƒæ•™è‚²ç›¸å…³</view>
        </view>
        <view class="form-actions">
          <view class="form-btn cancel-btn" bindtap="hidePublishModal">å–æ¶ˆ</view>
          <view class="form-btn confirm-btn" bindtap="submitPublish">å‘å¸ƒ</view>
        </view>
      </view>
    </view>
  </view>
</view>